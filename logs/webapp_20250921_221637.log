2025-09-21 22:16:37 [INFO] webapp - ==== Runtime Env ====
2025-09-21 22:16:37 [INFO] webapp - Python: 3.12.6 (tags/v3.12.6:a4a2d2b, Sep  6 2024, 20:11:23) [MSC v.1940 64 bit (AMD64)]
2025-09-21 22:16:37 [INFO] webapp - OS: Windows 10.0.26100
2025-09-21 22:16:37 [INFO] webapp - torch: 2.5.0+cu121 (cuda=True) | transformers: 4.46.1 | diffusers: 0.32.0
2025-09-21 22:16:37 [INFO] webapp - Device: NVIDIA GeForce RTX 4090 Laptop GPU
2025-09-21 22:16:37 [INFO] webapp - Log file: C:\Users\23154\Downloads\YUME-main-1\YUME-main\logs\webapp_20250921_221637.log
2025-09-21 22:16:37 [INFO] webapp - [LAUNCH] 即将启动：http://127.0.0.1:7665
2025-09-21 22:16:37 [INFO] webapp - [LAUNCH] Log file: C:\Users\23154\Downloads\YUME-main-1\YUME-main\logs\webapp_20250921_221637.log
2025-09-21 22:17:05 [INFO] webapp - [load_wan] start (BF16, DEVICE_ID=0)
2025-09-21 22:17:05 [INFO] webapp - [device] checking CUDA…
2025-09-21 22:17:05 [INFO] webapp - [device] using cuda:0 - NVIDIA GeForce RTX 4090 Laptop GPU
2025-09-21 22:20:48 [INFO] webapp - [load_wan] OK in 222.96s
2025-09-21 22:34:01 [ERROR] webapp - [api_generate_long] failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!
Traceback (most recent call last):
  File "C:\Users\23154\Downloads\YUME-main-1\YUME-main\webapp_single_gpu.py", line 892, in api_generate_long
    out_path, final_prompt = long_generate(g)
                             ^^^^^^^^^^^^^^^^
  File "C:\Users\23154\Downloads\YUME-main-1\YUME-main\.venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\23154\Downloads\YUME-main-1\YUME-main\webapp_single_gpu.py", line 548, in long_generate
    video_tail = vae.decode([latent[:,-latent_frame_zero:].cpu()])[0].cuda() #tiled_decode_overlap(wan.vae, latent, n_tiles = 4, latent_frame_zero=latent_frame_zero) #vae.decode([latent[:,-latent_frame_zero:]])[0]
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\23154\Downloads\YUME-main-1\YUME-main\wan23\modules\vae2_2.py", line 1049, in decode
    self.model.decode(u.unsqueeze(0),
  File "C:\Users\23154\Downloads\YUME-main-1\YUME-main\wan23\modules\vae2_2.py", line 819, in decode
    z = z / scale[1].view(1, self.z_dim, 1, 1, 1) + scale[0].view(
        ~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!
