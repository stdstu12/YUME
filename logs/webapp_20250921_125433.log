2025-09-21 12:54:34 [INFO] webapp - ==== Runtime Env ====
2025-09-21 12:54:34 [INFO] webapp - Python: 3.12.6 (tags/v3.12.6:a4a2d2b, Sep  6 2024, 20:11:23) [MSC v.1940 64 bit (AMD64)]
2025-09-21 12:54:34 [INFO] webapp - OS: Windows 10.0.26100
2025-09-21 12:54:34 [INFO] webapp - torch: 2.5.0+cu121 (cuda=True) | transformers: 4.46.1 | diffusers: 0.32.0
2025-09-21 12:54:34 [INFO] webapp - Device: NVIDIA GeForce RTX 4090 Laptop GPU
2025-09-21 12:54:34 [INFO] webapp - Log file: C:\Users\23154\Downloads\YUME-main-1\YUME-main\logs\webapp_20250921_125433.log
2025-09-21 12:54:34 [INFO] webapp - [LAUNCH] 即将启动：http://127.0.0.1:7665
2025-09-21 12:54:34 [INFO] webapp - [LAUNCH] Log file: C:\Users\23154\Downloads\YUME-main-1\YUME-main\logs\webapp_20250921_125433.log
2025-09-21 12:54:55 [INFO] webapp - [load_wan] start (BF16, DEVICE_ID=0)
2025-09-21 12:54:55 [INFO] webapp - [device] checking CUDA…
2025-09-21 12:54:55 [INFO] webapp - [device] using cuda:0 - NVIDIA GeForce RTX 4090 Laptop GPU
2025-09-21 12:58:44 [INFO] webapp - [load_wan] OK in 228.99s
2025-09-21 12:58:44 [INFO] webapp - [load_caption_model] start (BF16)
2025-09-21 12:59:03 [INFO] webapp - [load_caption_model] OK in 18.29s
2025-09-21 13:07:33 [ERROR] webapp - [api_generate_long] failed: 
Traceback (most recent call last):
  File "C:\Users\23154\Downloads\YUME-main-1\YUME-main\webapp_single_gpu.py", line 817, in api_generate_long
    out_path, final_prompt = long_generate(g)
                             ^^^^^^^^^^^^^^^^
  File "C:\Users\23154\Downloads\YUME-main-1\YUME-main\.venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\23154\Downloads\YUME-main-1\YUME-main\webapp_single_gpu.py", line 460, in long_generate
    noise_pred = transformer(latent_model_input, t=tvec, **arg_c)[0]
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\23154\Downloads\YUME-main-1\YUME-main\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\23154\Downloads\YUME-main-1\YUME-main\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\23154\Downloads\YUME-main-1\YUME-main\wan23\modules\model.py", line 875, in forward
    x = block(x, **kwargs)
        ^^^^^^^^^^^^^^^^^^
  File "C:\Users\23154\Downloads\YUME-main-1\YUME-main\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\23154\Downloads\YUME-main-1\YUME-main\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\23154\Downloads\YUME-main-1\YUME-main\wan23\modules\model.py", line 311, in forward
    y = self.self_attn(
        ^^^^^^^^^^^^^^^
  File "C:\Users\23154\Downloads\YUME-main-1\YUME-main\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\23154\Downloads\YUME-main-1\YUME-main\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\23154\Downloads\YUME-main-1\YUME-main\wan23\modules\model.py", line 199, in forward
    x = flash_attention(
        ^^^^^^^^^^^^^^^^
  File "C:\Users\23154\Downloads\YUME-main-1\YUME-main\wan23\modules\attention.py", line 112, in flash_attention
    assert FLASH_ATTN_2_AVAILABLE
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError
2025-09-21 13:27:48 [ERROR] webapp - [api_generate_long] failed: 
Traceback (most recent call last):
  File "C:\Users\23154\Downloads\YUME-main-1\YUME-main\webapp_single_gpu.py", line 817, in api_generate_long
    out_path, final_prompt = long_generate(g)
                             ^^^^^^^^^^^^^^^^
  File "C:\Users\23154\Downloads\YUME-main-1\YUME-main\.venv\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\23154\Downloads\YUME-main-1\YUME-main\webapp_single_gpu.py", line 460, in long_generate
    noise_pred = transformer(latent_model_input, t=tvec, **arg_c)[0]
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\23154\Downloads\YUME-main-1\YUME-main\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\23154\Downloads\YUME-main-1\YUME-main\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\23154\Downloads\YUME-main-1\YUME-main\wan23\modules\model.py", line 875, in forward
    x = block(x, **kwargs)
        ^^^^^^^^^^^^^^^^^^
  File "C:\Users\23154\Downloads\YUME-main-1\YUME-main\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\23154\Downloads\YUME-main-1\YUME-main\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\23154\Downloads\YUME-main-1\YUME-main\wan23\modules\model.py", line 311, in forward
    y = self.self_attn(
        ^^^^^^^^^^^^^^^
  File "C:\Users\23154\Downloads\YUME-main-1\YUME-main\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\23154\Downloads\YUME-main-1\YUME-main\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\23154\Downloads\YUME-main-1\YUME-main\wan23\modules\model.py", line 199, in forward
    x = flash_attention(
        ^^^^^^^^^^^^^^^^
  File "C:\Users\23154\Downloads\YUME-main-1\YUME-main\wan23\modules\attention.py", line 112, in flash_attention
    assert FLASH_ATTN_2_AVAILABLE
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError
